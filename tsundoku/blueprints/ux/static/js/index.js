(()=>{"use strict";var __webpack_modules__={561:(__unused_webpack_module,exports)=>{var __webpack_unused_export__;__webpack_unused_export__={value:!0};var entriesToDelete=[],entriesToAdd=[],all_triggers=["downloading","downloaded","renamed","moved","completed"],modalsCanBeClosed=!0;function showAddorEditProgressBars(){modalsCanBeClosed=!1,$(".closes-modals").addClass("is-hidden"),$(".submits-modals").addClass("is-hidden"),$("progress").removeClass("is-hidden")}function hideAddorEditProgressBars(){modalsCanBeClosed=!0,$(".closes-modals").removeClass("is-hidden"),$(".submits-modals").removeClass("is-hidden"),$("progress").addClass("is-hidden")}function updateTsundoku(){modalsCanBeClosed=!1,$("#updating-pg-bar").removeClass("is-hidden"),$("#update-button").addClass("is-hidden"),$("#close-update-modal-button").addClass("is-hidden"),$.ajax({url:"/update",type:"POST"}),setTimeout((function e(){setTimeout((function(){$.ajax({url:"/",type:"GET",success:function(){location.reload()},statusCode:{302:function(e){location.reload()}},complete:function(){e()},timeout:1e3})}),1e3)}),5e3)}function submitAddOrEditShowForm(e){showAddorEditProgressBars(),e.preventDefault();var o=$(this).closest("form").attr("action"),t=$(this).closest("form").attr("method"),s=$(this).closest("form").serialize();updateWebhooks();for(var d=0,a=entriesToDelete;d<a.length;d++)deleteShowEntry((r=a[d])[0],r[1]);for(var n=0,i=entriesToAdd;n<i.length;n++){var r;addShowEntry((r=i[n])[0],r[1],r[2])}$.ajax({url:o,type:t,data:s,success:function(e){location.reload()},error:function(e,o,t){hideAddorEditProgressBars(),alert("There was an error processing the request.")}})}function updateWebhooks(){document.getElementById("show-webhook-table")&&$("#show-webhook-table tbody tr").each((function(){var e=$(this).data("webhook"),o=$(this).data("show"),t=[];$(this).find("input").each((function(){$(this).prop("checked")&&t.push($(this).attr("name"))}));var s="/api/v1/shows/"+o+"/webhooks/"+e,d={triggers:t.join()};$.ajax({url:s,type:"PUT",data:d,error:function(e,o,t){console.error(o+": "+t)}})}))}function bufferShowEntryAddition(e){e.preventDefault();for(var o=$(this).closest("form")[0],t=new FormData(o),s=parseInt(t.get("show_id")),d=parseInt(t.get("episode")),a=t.get("magnet"),n=document.querySelector("#show-entry-table tbody"),i=[],r=0,l=Array.from(n.rows);r<l.length;r++){var c=l[r].cells[0],h=parseInt(c.innerHTML);i.push(h)}for(var u=0,w=entriesToAdd;u<w.length;u++){var p=w[u];i.push(p[1])}if(i.includes(d))return $("#add-show-entry-form input[name='episode']").addClass("is-danger").effect("shake",{distance:5,times:2},400),void $("#add-show-entry-form p").removeClass("is-hidden");$("#add-show-entry-form input[name='episode']").removeClass("is-danger"),$("#add-show-entry-form p").addClass("is-hidden"),entriesToAdd.push([s,d,a]),addRowToShowEntryTable({id:0,show_id:s,current_state:"buffered",episode:d})}function sortedIndex(e,o){for(var t=0,s=e.length;t<s;){var d=t+s>>>1;e[d]<o?t=d+1:s=d}return t}function addRowToShowEntryTable(e){for(var o=document.querySelector("#show-entry-table tbody"),t=[],s=0,d=Array.from(o.rows);s<d.length;s++){var a=d[s].cells[0],n=parseInt(a.innerHTML);t.push(n)}var i=sortedIndex(t,e.episode),r=o.insertRow(i),l=r.insertCell(0),c=r.insertCell(1),h=r.insertCell(2);$(l).html(e.episode.toString()),$(c).html(e.current_state);var u=document.createElement("button");$(u).addClass("delete"),$(u).on("click",(function(){"buffered"!==e.current_state&&bufferShowEntryDeletion(e.show_id,e.id),entriesToAdd=entriesToAdd.filter((function(o){return o[1]!=e.episode})),this.parentNode.parentNode.remove()})),h.appendChild(u)}function addRowToShowWebhookTable(webhook){var table=document.querySelector("#show-webhook-table tbody"),row=table.insertRow(-1);$(row).addClass("has-text-centered"),$(row).data("webhook",webhook.wh_id),$(row).data("show",webhook.show_id);for(var cell_basewh=row.insertCell(0),cell_t_downloading=row.insertCell(1),cell_t_downloaded=row.insertCell(2),cell_t_renamed=row.insertCell(3),cell_t_moved=row.insertCell(4),cell_t_completed=row.insertCell(5),cells=[cell_t_downloading,cell_t_downloaded,cell_t_renamed,cell_t_moved,cell_t_completed],_i=0,cells_1=cells;_i<cells_1.length;_i++){var cell=cells_1[_i];$(cell).addClass("is-vcentered");var checkbox=document.createElement("input");$(checkbox).attr("type","checkbox").appendTo($(cell))}for(var _a=0,all_triggers_1=all_triggers;_a<all_triggers_1.length;_a++){var trigger=all_triggers_1[_a],input=$(eval("cell_t_"+trigger)).find("input");$(input).attr("name",trigger),webhook.triggers.includes(trigger)&&input.prop("checked",!0)}var p=document.createElement("p");$(p).html(webhook.base.name),$(p).appendTo($(cell_basewh))}function bufferShowEntryDeletion(e,o){entriesToDelete.push([e,o])}function deleteShowEntry(e,o){var t="/api/v1/shows/"+e+"/entries/"+o;$.ajax({url:t,type:"DELETE"})}function addShowEntry(e,o,t){var s="/api/v1/shows/"+e+"/entries",d={episode:o,magnet:t};$.ajax({url:s,type:"POST",data:$.param(d),async:!1})}function deleteShowCache(e){var o="/api/v1/shows/"+e+"/cache";$.ajax({url:o,type:"DELETE",success:function(){window.location.reload()}})}function displayShowInfo(){$("#edit-control-tabs ul li").removeClass("is-active"),$("#show-info-tab").addClass("is-active"),$("#edit-show-form").removeClass("is-hidden"),$("#entry-tab-display").addClass("is-hidden"),$("#webhook-tab-display").addClass("is-hidden")}function displayShowEntries(){$("#edit-control-tabs ul li").removeClass("is-active"),$("#show-entry-tab").addClass("is-active"),$("#edit-show-form").addClass("is-hidden"),$("#entry-tab-display").removeClass("is-hidden"),$("#webhook-tab-display").addClass("is-hidden")}function displayShowWebhooks(){$("#edit-control-tabs ul li").removeClass("is-active"),$("#show-webhooks-tab").addClass("is-active"),$("#edit-show-form").addClass("is-hidden"),$("#entry-tab-display").addClass("is-hidden"),$("#webhook-tab-display").removeClass("is-hidden")}function openAddShowModal(){var e=$("#add-show-form");e.trigger("reset"),e.attr("action","/api/v1/shows"),e.attr("method","POST"),e.on("submit",submitAddOrEditShowForm),$(document.documentElement).addClass("is-clipped"),$("#add-show-modal").addClass("is-active")}function openEditShowModal(e){var o=$("#edit-show-form"),t=$("#add-show-entry-form"),s=$("#show-entry-table tbody"),d=$("#show-webhook-table tbody");displayShowInfo(),o.trigger("reset"),t.trigger("reset"),$("#edit-show-form :input").each((function(o,t){$(t).val(e[$(t).attr("name")])})),$("#fix-match-input").val(e.kitsu_id),s.empty(),d.empty();for(var a=0,n=e.entries;a<n.length;a++)addRowToShowEntryTable(n[a]);for(var i=0,r=e.webhooks;i<r.length;i++)addRowToShowWebhookTable(r[i]);$("#add-show-entry-form input[name='show_id']").val(e.id),o.attr("method","PUT"),o.attr("action","/api/v1/shows/"+e.id),o.on("submit",submitAddOrEditShowForm),t.on("submit",bufferShowEntryAddition),$("#del-cache-btn").on("click",(function(){deleteShowCache(e.id)})),$(document.documentElement).addClass("is-clipped"),$("#edit-show-modal").addClass("is-active")}function openDeleteShowModal(e){$("#delete-show-button").on("click",(function(o){o.preventDefault(),$.ajax({url:"/api/v1/shows/"+e.id,type:"DELETE",success:function(){location.reload()}})})),$("#item-to-delete-name").text(e.title),$(document.documentElement).addClass("is-clipped"),$("#delete-show-modal").addClass("is-active")}function toggleFixMatchDropdown(){$("#fix-match-dropdown").toggleClass("is-active")}function closeModals(){modalsCanBeClosed&&(entriesToDelete=[],entriesToAdd=[],$(".modal").removeClass("is-active"),$("#add-show-entry-form input[name='episode']").removeClass("is-danger"),$("#add-show-entry-form p").addClass("is-hidden"),$(document.documentElement).removeClass("is-clipped"))}$((function(){$(".notification .delete").each((function(){$(this).on("click",(function(){$(this).parent().remove()}))})),$("#fix-match-input").change((function(){$("input[name='kitsu_id']").val($(this).val())})),$("#all-shows-link").on("click",(function(){$(".column.is-hidden").removeClass("is-hidden"),$("#back-to-top-link").removeClass("is-hidden"),$(this).remove()})),$("#back-to-top-link").on("click",(function(){$("html, body").animate({scrollTop:0},"slow")}))})),window.displayShowInfo=displayShowInfo,window.openAddShowModal=openAddShowModal,window.openEditShowModal=openEditShowModal,window.openDeleteShowModal=openDeleteShowModal,window.closeModals=closeModals,window.toggleFixMatchDropdown=toggleFixMatchDropdown,window.displayShowEntries=displayShowEntries,window.displayShowWebhooks=displayShowWebhooks}},__webpack_module_cache__={};function __webpack_require__(e){if(__webpack_module_cache__[e])return __webpack_module_cache__[e].exports;var o=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](o,o.exports,__webpack_require__),o.exports}__webpack_require__(561)})();